The first isomorphism theorem is one of the classical results in universal algebra.
While this statement is usually about algebra structures in sets \cite{lynge2019}, we look at a generalization to the 1-truncated case.
More specifically, we formulate and prove this theorem for algebras for the signatures defined in Definition \ref{def:signature}.

Before we can do prove the isomorphism theorem, we need to generalize several notions from universal algebra to the 1-truncated case.
First of all, we need to define the image of homomorphisms of algebras.
We take the same approach as in Section \ref{sec:finite_limits}, meaning that we define the image using displayed algebras.
Second of all, we need to define congruence relations and their quotients.
The main idea here is to use Construction \ref{constr:alg_biadj}.
Here we lifted the groupoid quotient to a biadjunction from $\algG{\sign}$ to $\algebra{\sign}$.
This result also indicates how congruence relations will be defined.
Basically, a congruence relation on $X : \algebra{\sign}$ is a groupoid structure on $X$ which gives an algebra of groupoids.
Once these notions are in place, we can formulate and prove the first isomorphism theorem similarly to the set-theoretical version.

\subsection{The Image}
We start by defining the image.
This means that for each morphism $f : A \onecell B$ we must find a factorization $A \onecell \Im{f} \onecell B$.

\begin{problem}
\label{prob:image}
Given algebra $A$ and $B$ for a signature $\sign$ and a algebra morphism $f : A \onecell B$,
to construct an algebra $\Im(f)$ and morphisms $\ImProj{f} : A \onecell \Im{f}$ and $\ImInc{f} : \Im(f) \onecell B$. 
\end{problem}

\begin{construction}{prob:image}
We define $\Im(f)$ to be the total algebra $\TotalAlg Y$ of the following displayed algebra $Y$ over $B$:
\begin{itemize}
\item The underlying family of 1-types over $B$ is $Y(x) \eqdef \exists a : A.\ f(a) = x$.
\item For each $x : \polyAct{\pointconstr}{A}$, we are required to construct
a map $\DispAlgPoint{Y} : \polyDact{\pointconstr}{Y}(x) \rightarrow
\exists a : A.\ f(a) = \AlgPoint{B}(x)$. Assume given $\pover{x}
: \polyDact{\pointconstr}{Y}(x)$. By induction on the polynomial
$\pointconstr$, it is possible to derive from $\pover{x}$ an
inhabitant of $\exists y
: \polyAct{\pointconstr}{A}.\ \polyAct{\pointconstr}{f}(y) = x$. By
invoking the elimination principle of propositional truncation, in
order to define the map $\DispAlgPoint{Y}$ it is sufficient to
construct a map $f : \Sum {y
: \polyAct{\pointconstr}{A}}.\ \polyAct{\pointconstr}{f}(y) =
x \rightarrow \Sum {a : A}.\ f(a) = \AlgPoint{B}(x)$.  So assume given
$y : \polyAct{\pointconstr}{A}$ and a path $p
: \polyAct{\pointconstr}{f}(y) = x$. Take $f(y,p)$ to be the pair
consisting of $\AlgPoint{A}(y)$ and the path:
\[
f(\AlgPoint{A}(y))
\stackrel{\AlgMapPoint{f}(y)}{=}
\AlgPoint{B}(\polyAct{\pointconstr}{f}(y))
\stackrel{\ap {\AlgPoint{B}} p}{=}
\AlgPoint{B}(x)
\]
\item Since $Y(x)$ is a proposition for all $x : B$, the construction of
paths $\DispAlgPath{Y}{j}$ and globes $\DispAlgHomot{Y}{j}$ is
straightforward.
\end{itemize}

The map $\ImInc{f}$ is the first projection.
The morphism $\ImProj{f}$ sends an element $x : A$ to
$(f(x),\PC(x,\refl{f(x)}))$, where $\PC$ is the point constructor of
propositional truncation. 
\end{construction}

\subsection{Congruence Relations}
Next we define congruence relations and we show that each such relation gives a algebra in groupoids.
The difficulty here is constructing the homotopy constructor of that algebra.
For this reason, we define congruence relations in two steps, and we start by defining \emph{path congruence relations} and showing that these give rise to path algebras in groupoids.

\begin{definition}
Let $\sign$ be a signature and let $X : \algebra{\sign}$.
A \fat{path congruence relation} $R$ on $X$ consists of
\begin{itemize}
	\item a groupoid structure $R$ on $X$;
	\item for each $x, y : \polyAct{\pointconstr[\sign]}{X}$ and $f : \mor{\polyAct{\pointconstr[\sign]}{R}}{x}{y}$, a morphism $\AlgPoint{R} : \mor{R}{\AlgPoint{X}(x)}{\AlgPoint{X}(y)}$ and a proof that this assignment is functorial;
	\item a proof that the assignment $\Lam x, \idtoiso(\AlgPath{X}{j}(x))$ gives a natural transformation $\semEG{\pathleft[\sign]_j} \twocell \semEG{\pathright[\sign]_j}$ for each $j : \pathlabel[\sign]$.
\end{itemize}
\end{definition}

\begin{problem}
\label{prob:path_congruence_relation_to_grpd}
Given a path congruence relation $R$,
to construct $\toGrpdPathAlg{R} : \pathalgG{\sign}$.
\end{problem}

\begin{construction}{prob:path_congruence_relation_to_grpd}
We only discuss the data involved.
\begin{itemize}
	\item The carrier $\toGrpdPathAlg{R}$ is the groupoid whose type of objects is $X$ and whose morphisms are given by $R$.
	\item Next we define a functor $\semPG{\pointconstr[\sign]}(\toGrpdPathAlg{R}) \onecell \toGrpdPathAlg{R}$. It is defined to be $\AlgPoint{X}$ on the objects and on the morphisms, it is defined to be $\AlgPoint{R}$.
	\item Lastly, we define a natural transformation $\semEG{\pathleft[\sign]_j} \twocell \semEG{\pathright[\sign]_j}$ for each $j : \pathlabel[\sign]$. The component function of this transformation is $\Lam x, \idtoiso(\AlgPath{X}{j}(x))$. \qedhere
\end{itemize}
\end{construction}

Now let us look at what we need to show that $\toGrpdPathAlg{R}$ is an algebra.
To show that it is indeed an algebra, we need to verify the homotopy constructor.
Since this constructor has both a point and path constructor, we need to check an equality of morphisms of $\toGrpdPathAlg{R}$, which depend on points of $X$ and morphisms of $\toGrpdPathAlg{R}$.
As a result, we cannot reuse the homotopy constructor of $X$, because it only depends on points of $X$ and paths in $X$.
This means that to construct a groupoid algebra, the homotopy constructor needs to be constructed from scratch.
This is reflected in the following definition.

\begin{definition}
A path congruence relation $R$ is a \fat{congruence} relation if $\toGrpdPathAlg{R}$ is an algebra in groupoids.
\end{definition}

Note that each congruence relation $R$ gives rise to an algebra $\toGrpdAlg{R} : \algG{\sign}$.
By Construction \ref{constr:alg_biadj}, the groupoid quotient lifts to $\alggquot : \pseudo(\algG{\sign}, \algebra{\sign})$.
Hence, we can construct an algebra $\alggquot(\toGrpdAlg{R}) : \algebra{\sign}$ from a congruence relation $R$.
Since $\alggquot$ is a left biadjoint, we also get a mapping property for $\alggquot(\toGrpdAlg{R})$.

\begin{remark}
\label{remark:mapping_property_congruence}
Suppose, we have two algebra $X, Y : \algebra{\sign}$ and a congruence relation $R$ on $X$.
By the biadjunction, we get a morphism $\alggquot{\toGrpdAlg{R}} \onecell Y$ from $R \onecell \algpgrpd{Y}$.
Using this, we can give conditions for when a homomorphism $f : X \onecell Y$ factors through $\alggquot{\toGrpdAlg{R}}$.
We can unfold the definition to find the necessary ingredients for the factorization.
For example, to show that $f$ lifts to a functor, we need to provide a path $f_2 : f(x) = f(y)$ for each $x, y : X$ and $p : \mor{R}{x}{y}$, and equalities $f_2(\idpath(x)) =\idpath(f_2(x))$ and $f_2(p \cdot q) = f_2(p) \vcomp f_2(q)$.
\end{remark}

\subsection{The First Isomorphism Theorem}
Now let us prove a generalization of the first isomorphism theorem to the 1-truncated case.
Note that our proof follows the same steps as the proof of the first isomorphism theorem for sets.
Let us start by characterizing adjoint equivalences in $\algM(\sign)$.

\begin{proposition}
\label{prop:algebra_adjequiv}
Suppose we have a signature $\sign$, algebras $X, Y : \algM(\sign)$, and a homomorphism $f : X \onecell Y$.
Then $f$ is an adjoint equivalence in $\algM(\sign)$ if its carrier is an adjoint equivalence in $\onetypes$.
\end{proposition}

\begin{theorem}\label{thm:iso_thm}
Let $\sign$ be a signature.
Suppose, we have algebras $X, Y : \algM(\sign)$ and a homomorphism $f : X \onecell Y$.
Then we have a congruence relation $R$ on $X$ and an adjoint equivalence $\overline{f} : \alggquot(\toGrpdAlg{R}) \onecell \Im(f)$.
\end{theorem}

\begin{proof}
The proof is done in three steps.
First, we define the congruence relation $R$ on $X$ by setting $R(x, y) := f(x) = f(y)$.
Second, we factor the map $\ImProj{f}$ from $X$ to the image as a map $\overline{f}$ from $\alggquot(\toGrpdAlg{R})$ to $\Im(f)$ using Construction \ref{remark:mapping_property_congruence}.
Lastly, we show that the $\overline{f}$ is an adjoint equivalence using Proposition \ref{prop:algebra_adjequiv}.
This is done by showing that the fibers are contractible.
Showing that the fibers are inhabited and propositional is similarly to proving the surjectivity and injectivity for the set-theoretical first isomorphism theorem \cite{lynge2019}.
\end{proof}
